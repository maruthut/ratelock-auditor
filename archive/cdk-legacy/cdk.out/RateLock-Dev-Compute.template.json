{
 "Description": "RateLock ECS Fargate services for dev environment",
 "Resources": {
  "RateLockCluster6356FFDD": {
   "Type": "AWS::ECS::Cluster",
   "Properties": {
    "ClusterName": "ratelock-cluster",
    "ClusterSettings": [
     {
      "Name": "containerInsights",
      "Value": "disabled"
     }
    ],
    "Tags": [
     {
      "Key": "Environment",
      "Value": "dev"
     },
     {
      "Key": "ManagedBy",
      "Value": "CDK"
     },
     {
      "Key": "Project",
      "Value": "RateLock"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "RateLock-Dev-Compute/RateLockCluster/Resource"
   }
  },
  "ConversionEngineRepo509F680B": {
   "Type": "AWS::ECR::Repository",
   "Properties": {
    "LifecyclePolicy": {
     "LifecyclePolicyText": "{\"rules\":[{\"rulePriority\":1,\"description\":\"Keep only 10 most recent images\",\"selection\":{\"tagStatus\":\"any\",\"countType\":\"imageCountMoreThan\",\"countNumber\":10},\"action\":{\"type\":\"expire\"}}]}"
    },
    "RepositoryName": "ratelock/conversion-engine",
    "Tags": [
     {
      "Key": "Environment",
      "Value": "dev"
     },
     {
      "Key": "ManagedBy",
      "Value": "CDK"
     },
     {
      "Key": "Project",
      "Value": "RateLock"
     }
    ]
   },
   "UpdateReplacePolicy": "Retain",
   "DeletionPolicy": "Retain",
   "Metadata": {
    "aws:cdk:path": "RateLock-Dev-Compute/ConversionEngineRepo/Resource"
   }
  },
  "RateSyncRepoBEBB45A1": {
   "Type": "AWS::ECR::Repository",
   "Properties": {
    "LifecyclePolicy": {
     "LifecyclePolicyText": "{\"rules\":[{\"rulePriority\":1,\"description\":\"Keep only 10 most recent images\",\"selection\":{\"tagStatus\":\"any\",\"countType\":\"imageCountMoreThan\",\"countNumber\":10},\"action\":{\"type\":\"expire\"}}]}"
    },
    "RepositoryName": "ratelock/ratesync",
    "Tags": [
     {
      "Key": "Environment",
      "Value": "dev"
     },
     {
      "Key": "ManagedBy",
      "Value": "CDK"
     },
     {
      "Key": "Project",
      "Value": "RateLock"
     }
    ]
   },
   "UpdateReplacePolicy": "Retain",
   "DeletionPolicy": "Retain",
   "Metadata": {
    "aws:cdk:path": "RateLock-Dev-Compute/RateSyncRepo/Resource"
   }
  },
  "TaskExecutionRole250D2532": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "ecs-tasks.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy"
       ]
      ]
     }
    ],
    "Tags": [
     {
      "Key": "Environment",
      "Value": "dev"
     },
     {
      "Key": "ManagedBy",
      "Value": "CDK"
     },
     {
      "Key": "Project",
      "Value": "RateLock"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "RateLock-Dev-Compute/TaskExecutionRole/Resource"
   }
  },
  "TaskExecutionRoleDefaultPolicyA84DD1B0": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": [
        "ecr:BatchCheckLayerAvailability",
        "ecr:BatchGetImage",
        "ecr:GetDownloadUrlForLayer"
       ],
       "Effect": "Allow",
       "Resource": [
        {
         "Fn::GetAtt": [
          "ConversionEngineRepo509F680B",
          "Arn"
         ]
        },
        {
         "Fn::GetAtt": [
          "RateSyncRepoBEBB45A1",
          "Arn"
         ]
        }
       ]
      },
      {
       "Action": "ecr:GetAuthorizationToken",
       "Effect": "Allow",
       "Resource": "*"
      },
      {
       "Action": [
        "logs:CreateLogStream",
        "logs:PutLogEvents"
       ],
       "Effect": "Allow",
       "Resource": [
        {
         "Fn::GetAtt": [
          "ConversionEngineLogGroupF81B52EF",
          "Arn"
         ]
        },
        {
         "Fn::GetAtt": [
          "RateSyncLogGroupF0D0E197",
          "Arn"
         ]
        }
       ]
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "TaskExecutionRoleDefaultPolicyA84DD1B0",
    "Roles": [
     {
      "Ref": "TaskExecutionRole250D2532"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "RateLock-Dev-Compute/TaskExecutionRole/DefaultPolicy/Resource"
   }
  },
  "TaskRole30FC0FBB": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "ecs-tasks.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "Policies": [
     {
      "PolicyDocument": {
       "Statement": [
        {
         "Action": [
          "dynamodb:DeleteItem",
          "dynamodb:GetItem",
          "dynamodb:PutItem",
          "dynamodb:Query",
          "dynamodb:Scan",
          "dynamodb:UpdateItem"
         ],
         "Effect": "Allow",
         "Resource": [
          {
           "Fn::ImportValue": "RateLock-Dev-Database:ExportsOutputFnGetAttConversionAuditLogTable3B1E57FFArn30528F82"
          },
          {
           "Fn::ImportValue": "RateLock-Dev-Database:ExportsOutputFnGetAttRateCacheTable7CBD0DE3Arn69888416"
          }
         ]
        }
       ],
       "Version": "2012-10-17"
      },
      "PolicyName": "DynamoDBAccess"
     }
    ],
    "Tags": [
     {
      "Key": "Environment",
      "Value": "dev"
     },
     {
      "Key": "ManagedBy",
      "Value": "CDK"
     },
     {
      "Key": "Project",
      "Value": "RateLock"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "RateLock-Dev-Compute/TaskRole/Resource"
   }
  },
  "ConversionEngineLogGroupF81B52EF": {
   "Type": "AWS::Logs::LogGroup",
   "Properties": {
    "LogGroupName": "/ecs/ratelock-conversion-engine",
    "RetentionInDays": 7,
    "Tags": [
     {
      "Key": "Environment",
      "Value": "dev"
     },
     {
      "Key": "ManagedBy",
      "Value": "CDK"
     },
     {
      "Key": "Project",
      "Value": "RateLock"
     }
    ]
   },
   "UpdateReplacePolicy": "Retain",
   "DeletionPolicy": "Retain",
   "Metadata": {
    "aws:cdk:path": "RateLock-Dev-Compute/ConversionEngineLogGroup/Resource"
   }
  },
  "RateSyncLogGroupF0D0E197": {
   "Type": "AWS::Logs::LogGroup",
   "Properties": {
    "LogGroupName": "/ecs/ratelock-ratesync",
    "RetentionInDays": 7,
    "Tags": [
     {
      "Key": "Environment",
      "Value": "dev"
     },
     {
      "Key": "ManagedBy",
      "Value": "CDK"
     },
     {
      "Key": "Project",
      "Value": "RateLock"
     }
    ]
   },
   "UpdateReplacePolicy": "Retain",
   "DeletionPolicy": "Retain",
   "Metadata": {
    "aws:cdk:path": "RateLock-Dev-Compute/RateSyncLogGroup/Resource"
   }
  },
  "ConversionEngineTaskD8F48D04": {
   "Type": "AWS::ECS::TaskDefinition",
   "Properties": {
    "ContainerDefinitions": [
     {
      "Environment": [
       {
        "Name": "AWS_DEFAULT_REGION",
        "Value": "us-east-1"
       },
       {
        "Name": "RATE_CACHE_TABLE",
        "Value": {
         "Fn::ImportValue": "RateLock-Dev-Database:ExportsOutputRefRateCacheTable7CBD0DE31C90AEF1"
        }
       },
       {
        "Name": "AUDIT_LOG_TABLE",
        "Value": {
         "Fn::ImportValue": "RateLock-Dev-Database:ExportsOutputRefConversionAuditLogTable3B1E57FF533AF931"
        }
       },
       {
        "Name": "ENVIRONMENT",
        "Value": "production"
       }
      ],
      "Essential": true,
      "HealthCheck": {
       "Command": [
        "CMD-SHELL",
        "curl -f http://localhost:8080/health || exit 1"
       ],
       "Interval": 30,
       "Retries": 3,
       "StartPeriod": 60,
       "Timeout": 5
      },
      "Image": {
       "Fn::Join": [
        "",
        [
         {
          "Fn::Select": [
           4,
           {
            "Fn::Split": [
             ":",
             {
              "Fn::GetAtt": [
               "ConversionEngineRepo509F680B",
               "Arn"
              ]
             }
            ]
           }
          ]
         },
         ".dkr.ecr.",
         {
          "Fn::Select": [
           3,
           {
            "Fn::Split": [
             ":",
             {
              "Fn::GetAtt": [
               "ConversionEngineRepo509F680B",
               "Arn"
              ]
             }
            ]
           }
          ]
         },
         ".",
         {
          "Ref": "AWS::URLSuffix"
         },
         "/",
         {
          "Ref": "ConversionEngineRepo509F680B"
         },
         ":latest"
        ]
       ]
      },
      "LogConfiguration": {
       "LogDriver": "awslogs",
       "Options": {
        "awslogs-group": {
         "Ref": "ConversionEngineLogGroupF81B52EF"
        },
        "awslogs-stream-prefix": "ecs",
        "awslogs-region": "us-east-1"
       }
      },
      "Name": "conversion-engine",
      "PortMappings": [
       {
        "ContainerPort": 8080,
        "Protocol": "tcp"
       }
      ]
     }
    ],
    "Cpu": "256",
    "ExecutionRoleArn": {
     "Fn::GetAtt": [
      "TaskExecutionRole250D2532",
      "Arn"
     ]
    },
    "Family": "ratelock-conversion-engine",
    "Memory": "512",
    "NetworkMode": "awsvpc",
    "RequiresCompatibilities": [
     "FARGATE"
    ],
    "Tags": [
     {
      "Key": "Environment",
      "Value": "dev"
     },
     {
      "Key": "ManagedBy",
      "Value": "CDK"
     },
     {
      "Key": "Project",
      "Value": "RateLock"
     }
    ],
    "TaskRoleArn": {
     "Fn::GetAtt": [
      "TaskRole30FC0FBB",
      "Arn"
     ]
    }
   },
   "Metadata": {
    "aws:cdk:path": "RateLock-Dev-Compute/ConversionEngineTask/Resource"
   }
  },
  "RateSyncTask21038A71": {
   "Type": "AWS::ECS::TaskDefinition",
   "Properties": {
    "ContainerDefinitions": [
     {
      "Environment": [
       {
        "Name": "AWS_DEFAULT_REGION",
        "Value": "us-east-1"
       },
       {
        "Name": "RATE_CACHE_TABLE",
        "Value": {
         "Fn::ImportValue": "RateLock-Dev-Database:ExportsOutputRefRateCacheTable7CBD0DE31C90AEF1"
        }
       },
       {
        "Name": "ENVIRONMENT",
        "Value": "production"
       }
      ],
      "Essential": true,
      "Image": {
       "Fn::Join": [
        "",
        [
         {
          "Fn::Select": [
           4,
           {
            "Fn::Split": [
             ":",
             {
              "Fn::GetAtt": [
               "RateSyncRepoBEBB45A1",
               "Arn"
              ]
             }
            ]
           }
          ]
         },
         ".dkr.ecr.",
         {
          "Fn::Select": [
           3,
           {
            "Fn::Split": [
             ":",
             {
              "Fn::GetAtt": [
               "RateSyncRepoBEBB45A1",
               "Arn"
              ]
             }
            ]
           }
          ]
         },
         ".",
         {
          "Ref": "AWS::URLSuffix"
         },
         "/",
         {
          "Ref": "RateSyncRepoBEBB45A1"
         },
         ":latest"
        ]
       ]
      },
      "LogConfiguration": {
       "LogDriver": "awslogs",
       "Options": {
        "awslogs-group": {
         "Ref": "RateSyncLogGroupF0D0E197"
        },
        "awslogs-stream-prefix": "ecs",
        "awslogs-region": "us-east-1"
       }
      },
      "Name": "ratesync"
     }
    ],
    "Cpu": "256",
    "ExecutionRoleArn": {
     "Fn::GetAtt": [
      "TaskExecutionRole250D2532",
      "Arn"
     ]
    },
    "Family": "ratelock-ratesync",
    "Memory": "512",
    "NetworkMode": "awsvpc",
    "RequiresCompatibilities": [
     "FARGATE"
    ],
    "Tags": [
     {
      "Key": "Environment",
      "Value": "dev"
     },
     {
      "Key": "ManagedBy",
      "Value": "CDK"
     },
     {
      "Key": "Project",
      "Value": "RateLock"
     }
    ],
    "TaskRoleArn": {
     "Fn::GetAtt": [
      "TaskRole30FC0FBB",
      "Arn"
     ]
    }
   },
   "Metadata": {
    "aws:cdk:path": "RateLock-Dev-Compute/RateSyncTask/Resource"
   }
  },
  "RateSyncTaskEventsRoleBC6228BD": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "events.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "Tags": [
     {
      "Key": "Environment",
      "Value": "dev"
     },
     {
      "Key": "ManagedBy",
      "Value": "CDK"
     },
     {
      "Key": "Project",
      "Value": "RateLock"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "RateLock-Dev-Compute/RateSyncTask/EventsRole/Resource"
   }
  },
  "RateSyncTaskEventsRoleDefaultPolicy8E1FB230": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": "ecs:RunTask",
       "Condition": {
        "ArnEquals": {
         "ecs:cluster": {
          "Fn::GetAtt": [
           "RateLockCluster6356FFDD",
           "Arn"
          ]
         }
        }
       },
       "Effect": "Allow",
       "Resource": {
        "Ref": "RateSyncTask21038A71"
       }
      },
      {
       "Action": "iam:PassRole",
       "Effect": "Allow",
       "Resource": [
        {
         "Fn::GetAtt": [
          "TaskExecutionRole250D2532",
          "Arn"
         ]
        },
        {
         "Fn::GetAtt": [
          "TaskRole30FC0FBB",
          "Arn"
         ]
        }
       ]
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "RateSyncTaskEventsRoleDefaultPolicy8E1FB230",
    "Roles": [
     {
      "Ref": "RateSyncTaskEventsRoleBC6228BD"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "RateLock-Dev-Compute/RateSyncTask/EventsRole/DefaultPolicy/Resource"
   }
  },
  "RateSyncTaskSecurityGroupA6567E8D": {
   "Type": "AWS::EC2::SecurityGroup",
   "Properties": {
    "GroupDescription": "RateLock-Dev-Compute/RateSyncTask/SecurityGroup",
    "SecurityGroupEgress": [
     {
      "CidrIp": "0.0.0.0/0",
      "Description": "Allow all outbound traffic by default",
      "IpProtocol": "-1"
     }
    ],
    "Tags": [
     {
      "Key": "Environment",
      "Value": "dev"
     },
     {
      "Key": "ManagedBy",
      "Value": "CDK"
     },
     {
      "Key": "Project",
      "Value": "RateLock"
     }
    ],
    "VpcId": "vpc-05e281cbc42470e1f"
   },
   "Metadata": {
    "aws:cdk:path": "RateLock-Dev-Compute/RateSyncTask/SecurityGroup/Resource"
   }
  },
  "RateLockALB91B2349A": {
   "Type": "AWS::ElasticLoadBalancingV2::LoadBalancer",
   "Properties": {
    "LoadBalancerAttributes": [
     {
      "Key": "deletion_protection.enabled",
      "Value": "false"
     }
    ],
    "Name": "ratelock-alb",
    "Scheme": "internet-facing",
    "SecurityGroups": [
     {
      "Fn::GetAtt": [
       "RateLockALBSecurityGroup96768DE0",
       "GroupId"
      ]
     }
    ],
    "Subnets": [
     "subnet-0213544bca0ad7b6c",
     "subnet-071ba2ea9138b0ced",
     "subnet-068e42bb2a0b457fa",
     "subnet-040d6852d43f9151b",
     "subnet-0b41ed93d83ce607a",
     "subnet-0c6e91d815a485b5c"
    ],
    "Tags": [
     {
      "Key": "Environment",
      "Value": "dev"
     },
     {
      "Key": "ManagedBy",
      "Value": "CDK"
     },
     {
      "Key": "Project",
      "Value": "RateLock"
     }
    ],
    "Type": "application"
   },
   "Metadata": {
    "aws:cdk:path": "RateLock-Dev-Compute/RateLockALB/Resource"
   }
  },
  "RateLockALBSecurityGroup96768DE0": {
   "Type": "AWS::EC2::SecurityGroup",
   "Properties": {
    "GroupDescription": "Automatically created Security Group for ELB RateLockDevComputeRateLockALBEE3E5E3D",
    "SecurityGroupIngress": [
     {
      "CidrIp": "0.0.0.0/0",
      "Description": "Allow from anyone on port 80",
      "FromPort": 80,
      "IpProtocol": "tcp",
      "ToPort": 80
     }
    ],
    "Tags": [
     {
      "Key": "Environment",
      "Value": "dev"
     },
     {
      "Key": "ManagedBy",
      "Value": "CDK"
     },
     {
      "Key": "Project",
      "Value": "RateLock"
     }
    ],
    "VpcId": "vpc-05e281cbc42470e1f"
   },
   "Metadata": {
    "aws:cdk:path": "RateLock-Dev-Compute/RateLockALB/SecurityGroup/Resource"
   }
  },
  "RateLockALBSecurityGrouptoRateLockDevComputeConversionEngineServiceSecurityGroup61FFFCAC80807FA13274": {
   "Type": "AWS::EC2::SecurityGroupEgress",
   "Properties": {
    "Description": "Load balancer to target",
    "DestinationSecurityGroupId": {
     "Fn::GetAtt": [
      "ConversionEngineServiceSecurityGroup13F3A1A7",
      "GroupId"
     ]
    },
    "FromPort": 8080,
    "GroupId": {
     "Fn::GetAtt": [
      "RateLockALBSecurityGroup96768DE0",
      "GroupId"
     ]
    },
    "IpProtocol": "tcp",
    "ToPort": 8080
   },
   "Metadata": {
    "aws:cdk:path": "RateLock-Dev-Compute/RateLockALB/SecurityGroup/to RateLockDevComputeConversionEngineServiceSecurityGroup61FFFCAC:8080"
   }
  },
  "RateLockALBALBListenerA87976D1": {
   "Type": "AWS::ElasticLoadBalancingV2::Listener",
   "Properties": {
    "DefaultActions": [
     {
      "TargetGroupArn": {
       "Ref": "ConversionEngineTargetGroup59E48CF9"
      },
      "Type": "forward"
     }
    ],
    "LoadBalancerArn": {
     "Ref": "RateLockALB91B2349A"
    },
    "Port": 80,
    "Protocol": "HTTP"
   },
   "Metadata": {
    "aws:cdk:path": "RateLock-Dev-Compute/RateLockALB/ALBListener/Resource"
   }
  },
  "ConversionEngineTargetGroup59E48CF9": {
   "Type": "AWS::ElasticLoadBalancingV2::TargetGroup",
   "Properties": {
    "HealthCheckIntervalSeconds": 30,
    "HealthCheckPath": "/health",
    "HealthCheckTimeoutSeconds": 5,
    "HealthyThresholdCount": 2,
    "Matcher": {
     "HttpCode": "200"
    },
    "Port": 8080,
    "Protocol": "HTTP",
    "Tags": [
     {
      "Key": "Environment",
      "Value": "dev"
     },
     {
      "Key": "ManagedBy",
      "Value": "CDK"
     },
     {
      "Key": "Project",
      "Value": "RateLock"
     }
    ],
    "TargetGroupAttributes": [
     {
      "Key": "stickiness.enabled",
      "Value": "false"
     }
    ],
    "TargetType": "ip",
    "UnhealthyThresholdCount": 3,
    "VpcId": "vpc-05e281cbc42470e1f"
   },
   "Metadata": {
    "aws:cdk:path": "RateLock-Dev-Compute/ConversionEngineTargetGroup/Resource"
   }
  },
  "ConversionEngineService6DEDF5F9": {
   "Type": "AWS::ECS::Service",
   "Properties": {
    "Cluster": {
     "Ref": "RateLockCluster6356FFDD"
    },
    "DeploymentConfiguration": {
     "Alarms": {
      "AlarmNames": [],
      "Enable": false,
      "Rollback": false
     },
     "MaximumPercent": 200,
     "MinimumHealthyPercent": 50
    },
    "DesiredCount": 1,
    "EnableECSManagedTags": false,
    "HealthCheckGracePeriodSeconds": 120,
    "LaunchType": "FARGATE",
    "LoadBalancers": [
     {
      "ContainerName": "conversion-engine",
      "ContainerPort": 8080,
      "TargetGroupArn": {
       "Ref": "ConversionEngineTargetGroup59E48CF9"
      }
     }
    ],
    "NetworkConfiguration": {
     "AwsvpcConfiguration": {
      "AssignPublicIp": "ENABLED",
      "SecurityGroups": [
       {
        "Fn::GetAtt": [
         "ConversionEngineServiceSecurityGroup13F3A1A7",
         "GroupId"
        ]
       }
      ],
      "Subnets": [
       "subnet-0213544bca0ad7b6c",
       "subnet-071ba2ea9138b0ced",
       "subnet-068e42bb2a0b457fa",
       "subnet-040d6852d43f9151b",
       "subnet-0b41ed93d83ce607a",
       "subnet-0c6e91d815a485b5c"
      ]
     }
    },
    "ServiceName": "conversion-engine",
    "Tags": [
     {
      "Key": "Environment",
      "Value": "dev"
     },
     {
      "Key": "ManagedBy",
      "Value": "CDK"
     },
     {
      "Key": "Project",
      "Value": "RateLock"
     }
    ],
    "TaskDefinition": {
     "Ref": "ConversionEngineTaskD8F48D04"
    }
   },
   "DependsOn": [
    "RateLockALBALBListenerA87976D1",
    "TaskRole30FC0FBB"
   ],
   "Metadata": {
    "aws:cdk:path": "RateLock-Dev-Compute/ConversionEngineService/Service"
   }
  },
  "ConversionEngineServiceSecurityGroup13F3A1A7": {
   "Type": "AWS::EC2::SecurityGroup",
   "Properties": {
    "GroupDescription": "RateLock-Dev-Compute/ConversionEngineService/SecurityGroup",
    "SecurityGroupEgress": [
     {
      "CidrIp": "0.0.0.0/0",
      "Description": "Allow all outbound traffic by default",
      "IpProtocol": "-1"
     }
    ],
    "Tags": [
     {
      "Key": "Environment",
      "Value": "dev"
     },
     {
      "Key": "ManagedBy",
      "Value": "CDK"
     },
     {
      "Key": "Project",
      "Value": "RateLock"
     }
    ],
    "VpcId": "vpc-05e281cbc42470e1f"
   },
   "DependsOn": [
    "TaskRole30FC0FBB"
   ],
   "Metadata": {
    "aws:cdk:path": "RateLock-Dev-Compute/ConversionEngineService/SecurityGroup/Resource"
   }
  },
  "ConversionEngineServiceSecurityGroupfromRateLockDevComputeRateLockALBSecurityGroup2BCF8188808007059CB1": {
   "Type": "AWS::EC2::SecurityGroupIngress",
   "Properties": {
    "Description": "Load balancer to target",
    "FromPort": 8080,
    "GroupId": {
     "Fn::GetAtt": [
      "ConversionEngineServiceSecurityGroup13F3A1A7",
      "GroupId"
     ]
    },
    "IpProtocol": "tcp",
    "SourceSecurityGroupId": {
     "Fn::GetAtt": [
      "RateLockALBSecurityGroup96768DE0",
      "GroupId"
     ]
    },
    "ToPort": 8080
   },
   "DependsOn": [
    "TaskRole30FC0FBB"
   ],
   "Metadata": {
    "aws:cdk:path": "RateLock-Dev-Compute/ConversionEngineService/SecurityGroup/from RateLockDevComputeRateLockALBSecurityGroup2BCF8188:8080"
   }
  },
  "RateSyncScheduleB1FB2F0F": {
   "Type": "AWS::Events::Rule",
   "Properties": {
    "Description": "Trigger RateSync service every hour",
    "Name": "ratelock-hourly-sync",
    "ScheduleExpression": "rate(1 hour)",
    "State": "ENABLED",
    "Targets": [
     {
      "Arn": {
       "Fn::GetAtt": [
        "RateLockCluster6356FFDD",
        "Arn"
       ]
      },
      "EcsParameters": {
       "LaunchType": "FARGATE",
       "NetworkConfiguration": {
        "AwsVpcConfiguration": {
         "AssignPublicIp": "ENABLED",
         "SecurityGroups": [
          {
           "Fn::GetAtt": [
            "RateSyncTaskSecurityGroupA6567E8D",
            "GroupId"
           ]
          }
         ],
         "Subnets": [
          "subnet-0213544bca0ad7b6c",
          "subnet-071ba2ea9138b0ced",
          "subnet-068e42bb2a0b457fa",
          "subnet-040d6852d43f9151b",
          "subnet-0b41ed93d83ce607a",
          "subnet-0c6e91d815a485b5c"
         ]
        }
       },
       "PlatformVersion": "LATEST",
       "TaskCount": 1,
       "TaskDefinitionArn": {
        "Ref": "RateSyncTask21038A71"
       }
      },
      "Id": "Target0",
      "Input": "{}",
      "RoleArn": {
       "Fn::GetAtt": [
        "RateSyncTaskEventsRoleBC6228BD",
        "Arn"
       ]
      }
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "RateLock-Dev-Compute/RateSyncSchedule/Resource"
   }
  },
  "CDKMetadata": {
   "Type": "AWS::CDK::Metadata",
   "Properties": {
    "Analytics": "v2:deflate64:H4sIAAAAAAAA/31R204CMRD9Ft5LdTF+gOIlJiSShXczlHEdKe2mM4WQpv9uurvgqolPc27TtKczXVXXuprAkadmu5ta2ui0EjA7VSP7GAwqOPJbQsM6zW1kwaDm7+4MnyA0ILgG3j3gOzkS8q4EfiveCZDDMNKG3RWGAxksSwPMCk3QqcbWM4kPp+J9s6wI9jrV3nZL3Vx6S6bL9Sgr6xvWaeGb5+BjW5wzLsfPdFqhiYHkdPH/Fx6bgMx/5BfX6VmhBRYy1sN2AxacIdccZjrdta0lA+XFCw/b+87rS/zBxzliQTdkznjkryE0KJdrjmhWeEAnrFMdh3aixZwLeo3SRumr7L82q+VJPry7utFVpW8nn0w0DdEJ7VHX/fwCMD1EISICAAA="
   },
   "Metadata": {
    "aws:cdk:path": "RateLock-Dev-Compute/CDKMetadata/Default"
   }
  }
 },
 "Outputs": {
  "LoadBalancerDNS": {
   "Description": "DNS name of the Application Load Balancer",
   "Value": {
    "Fn::GetAtt": [
     "RateLockALB91B2349A",
     "DNSName"
    ]
   },
   "Export": {
    "Name": "RateLock-Dev-Compute-LoadBalancerDNS"
   }
  },
  "ConversionEngineRepoUri": {
   "Description": "URI of the ConversionEngine ECR repository",
   "Value": {
    "Fn::Join": [
     "",
     [
      {
       "Fn::Select": [
        4,
        {
         "Fn::Split": [
          ":",
          {
           "Fn::GetAtt": [
            "ConversionEngineRepo509F680B",
            "Arn"
           ]
          }
         ]
        }
       ]
      },
      ".dkr.ecr.",
      {
       "Fn::Select": [
        3,
        {
         "Fn::Split": [
          ":",
          {
           "Fn::GetAtt": [
            "ConversionEngineRepo509F680B",
            "Arn"
           ]
          }
         ]
        }
       ]
      },
      ".",
      {
       "Ref": "AWS::URLSuffix"
      },
      "/",
      {
       "Ref": "ConversionEngineRepo509F680B"
      }
     ]
    ]
   }
  },
  "RateSyncRepoUri": {
   "Description": "URI of the RateSync ECR repository",
   "Value": {
    "Fn::Join": [
     "",
     [
      {
       "Fn::Select": [
        4,
        {
         "Fn::Split": [
          ":",
          {
           "Fn::GetAtt": [
            "RateSyncRepoBEBB45A1",
            "Arn"
           ]
          }
         ]
        }
       ]
      },
      ".dkr.ecr.",
      {
       "Fn::Select": [
        3,
        {
         "Fn::Split": [
          ":",
          {
           "Fn::GetAtt": [
            "RateSyncRepoBEBB45A1",
            "Arn"
           ]
          }
         ]
        }
       ]
      },
      ".",
      {
       "Ref": "AWS::URLSuffix"
      },
      "/",
      {
       "Ref": "RateSyncRepoBEBB45A1"
      }
     ]
    ]
   }
  }
 },
 "Parameters": {
  "BootstrapVersion": {
   "Type": "AWS::SSM::Parameter::Value<String>",
   "Default": "/cdk-bootstrap/hnb659fds/version",
   "Description": "Version of the CDK Bootstrap resources in this environment, automatically retrieved from SSM Parameter Store. [cdk:skip]"
  }
 },
 "Rules": {
  "CheckBootstrapVersion": {
   "Assertions": [
    {
     "Assert": {
      "Fn::Not": [
       {
        "Fn::Contains": [
         [
          "1",
          "2",
          "3",
          "4",
          "5"
         ],
         {
          "Ref": "BootstrapVersion"
         }
        ]
       }
      ]
     },
     "AssertDescription": "CDK bootstrap stack version 6 required. Please run 'cdk bootstrap' with a recent version of the CDK CLI."
    }
   ]
  }
 }
}